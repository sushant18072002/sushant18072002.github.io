<!-- ENHANCED COMPONENTS LIBRARY -->
<style>
/* LIVE CHAT WIDGET */
.live-chat-widget {
    position: fixed; bottom: 2rem; right: 2rem; z-index: 1000;
    background: linear-gradient(135deg, var(--governor-bay), var(--ocean-blue));
    border-radius: 50px; padding: 1rem 1.5rem; color: white;
    box-shadow: 0 8px 25px rgba(37, 83, 235, 0.4);
    cursor: pointer; transition: all 0.3s ease;
}
.live-chat-widget:hover {
    transform: translateY(-2px); box-shadow: 0 12px 35px rgba(37, 83, 235, 0.5);
}
.chat-bubble {
    position: absolute; top: -0.5rem; right: -0.5rem;
    background: var(--soft-coral); color: white; border-radius: 50%;
    width: 20px; height: 20px; font-size: 0.7rem; font-weight: 600;
    display: flex; align-items: center; justify-content: center;
    animation: pulse 2s infinite;
}

/* CURRENCY CONVERTER */
.currency-selector {
    position: relative; display: inline-block;
}
.currency-dropdown {
    position: absolute; top: 100%; left: 0; background: white;
    border-radius: 0.5rem; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    min-width: 200px; z-index: 1000; display: none;
}
.currency-option {
    padding: 0.75rem 1rem; cursor: pointer; transition: all 0.3s ease;
    display: flex; justify-content: space-between; align-items: center;
}
.currency-option:hover { background: var(--primary-50); }

/* LANGUAGE SELECTOR */
.language-selector {
    position: relative; display: inline-block;
}
.language-dropdown {
    position: absolute; top: 100%; left: 0; background: white;
    border-radius: 0.5rem; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    min-width: 150px; z-index: 1000; display: none;
}
.language-option {
    padding: 0.75rem 1rem; cursor: pointer; transition: all 0.3s ease;
    display: flex; align-items: center; gap: 0.5rem;
}
.language-option:hover { background: var(--primary-50); }

/* ERROR HANDLING */
.error-container {
    background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05));
    border: 1px solid rgba(255, 107, 107, 0.2); border-radius: 0.75rem;
    padding: 1.5rem; text-align: center; margin: 2rem 0;
}
.error-icon { font-size: 3rem; margin-bottom: 1rem; }
.error-title { font-size: 1.5rem; font-weight: 600; color: var(--primary-900); margin-bottom: 0.5rem; }
.error-message { color: var(--primary-600); margin-bottom: 1.5rem; }
.error-actions { display: flex; gap: 1rem; justify-content: center; }

/* ACCESSIBILITY FEATURES */
.skip-link {
    position: absolute; top: -40px; left: 6px; background: var(--governor-bay);
    color: white; padding: 8px; text-decoration: none; border-radius: 0.25rem;
    z-index: 1000; transition: top 0.3s ease;
}
.skip-link:focus { top: 6px; }

.high-contrast-toggle {
    position: fixed; top: 100px; left: 1rem; background: var(--primary-900);
    color: white; border: none; padding: 0.5rem; border-radius: 0.25rem;
    cursor: pointer; z-index: 999;
}

/* SOCIAL SHARING */
.social-share {
    display: flex; gap: 0.5rem; justify-content: center; margin: 1rem 0;
}
.share-btn {
    width: 40px; height: 40px; border-radius: 50%; border: none;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: all 0.3s ease; color: white;
}
.share-facebook { background: #1877F2; }
.share-twitter { background: #1DA1F2; }
.share-linkedin { background: #0A66C2; }
.share-whatsapp { background: #25D366; }
.share-btn:hover { transform: translateY(-2px); }

/* LOYALTY PROGRAM */
.loyalty-card {
    background: linear-gradient(135deg, var(--premium-amber), #F59E0B);
    color: white; border-radius: 1rem; padding: 1.5rem; margin: 1rem 0;
}
.loyalty-points { font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem; }
.loyalty-tier { font-size: 0.9rem; opacity: 0.9; margin-bottom: 1rem; }
.loyalty-progress {
    background: rgba(255, 255, 255, 0.2); height: 8px; border-radius: 4px;
    overflow: hidden; margin-bottom: 0.5rem;
}
.loyalty-fill {
    background: white; height: 100%; border-radius: 4px;
    transition: width 0.5s ease;
}

/* REFERRAL SYSTEM */
.referral-banner {
    background: linear-gradient(135deg, var(--emerald), #059669);
    color: white; border-radius: 1rem; padding: 1.5rem; text-align: center;
    margin: 2rem 0;
}
.referral-code {
    background: rgba(255, 255, 255, 0.2); padding: 0.5rem 1rem;
    border-radius: 0.5rem; font-family: monospace; font-weight: 600;
    margin: 1rem 0; display: inline-block;
}
.copy-code-btn {
    background: white; color: var(--emerald); border: none;
    padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;
    font-weight: 600; margin-left: 0.5rem;
}

/* PUSH NOTIFICATION PROMPT */
.notification-prompt {
    position: fixed; top: 80px; right: 2rem; background: white;
    border-radius: 0.75rem; padding: 1.5rem; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    max-width: 300px; z-index: 1000; transform: translateX(120%);
    transition: transform 0.3s ease;
}
.notification-prompt.show { transform: translateX(0); }
.prompt-actions { display: flex; gap: 0.5rem; margin-top: 1rem; }
.prompt-btn {
    flex: 1; padding: 0.5rem; border-radius: 0.25rem; border: none;
    cursor: pointer; font-weight: 500; transition: all 0.3s ease;
}
.prompt-allow { background: var(--governor-bay); color: white; }
.prompt-deny { background: var(--primary-200); color: var(--primary-700); }

/* LOADING STATES */
.skeleton-loader {
    background: linear-gradient(90deg, var(--primary-100) 25%, var(--primary-50) 50%, var(--primary-100) 75%);
    background-size: 200% 100%; animation: skeleton-loading 1.5s infinite;
    border-radius: 0.5rem;
}
@keyframes skeleton-loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

.loading-dots {
    display: inline-flex; gap: 0.25rem;
}
.loading-dot {
    width: 8px; height: 8px; background: var(--governor-bay);
    border-radius: 50%; animation: loading-bounce 1.4s infinite ease-in-out;
}
.loading-dot:nth-child(1) { animation-delay: -0.32s; }
.loading-dot:nth-child(2) { animation-delay: -0.16s; }
@keyframes loading-bounce {
    0%, 80%, 100% { transform: scale(0); }
    40% { transform: scale(1); }
}

/* ADVANCED SEARCH */
.advanced-search-toggle {
    color: var(--governor-bay); cursor: pointer; font-size: 0.9rem;
    text-decoration: underline; margin-top: 0.5rem;
}
.advanced-search-panel {
    background: var(--primary-50); border-radius: 0.5rem; padding: 1.5rem;
    margin-top: 1rem; display: none;
}
.search-filters {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

/* PRICE ALERTS */
.price-alert-setup {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05));
    border: 1px solid rgba(245, 158, 11, 0.2); border-radius: 0.75rem;
    padding: 1.5rem; margin: 1rem 0;
}
.alert-toggle {
    display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;
}
.toggle-switch {
    position: relative; width: 50px; height: 24px; background: var(--primary-300);
    border-radius: 12px; cursor: pointer; transition: all 0.3s ease;
}
.toggle-switch.active { background: var(--governor-bay); }
.toggle-slider {
    position: absolute; top: 2px; left: 2px; width: 20px; height: 20px;
    background: white; border-radius: 50%; transition: all 0.3s ease;
}
.toggle-switch.active .toggle-slider { transform: translateX(26px); }
</style>

<!-- LIVE CHAT WIDGET -->
<div class="live-chat-widget" onclick="openLiveChat()">
    <i class="fas fa-comments"></i>
    <span style="margin-left: 0.5rem;">Need Help?</span>
    <div class="chat-bubble">3</div>
</div>

<!-- ERROR HANDLING TEMPLATE -->
<div class="error-container" style="display: none;" id="error-container">
    <div class="error-icon">⚠️</div>
    <h3 class="error-title">Oops! Something went wrong</h3>
    <p class="error-message">We're having trouble loading this page. Please try again.</p>
    <div class="error-actions">
        <button class="nav-btn secondary" onclick="location.reload()">Try Again</button>
        <button class="nav-btn" onclick="location.href='contact.html'">Contact Support</button>
    </div>
</div>

<!-- ACCESSIBILITY FEATURES -->
<a href="#main-content" class="skip-link">Skip to main content</a>
<button class="high-contrast-toggle" onclick="toggleHighContrast()" title="Toggle High Contrast">
    <i class="fas fa-adjust"></i>
</button>

<!-- NOTIFICATION PROMPT -->
<div class="notification-prompt" id="notification-prompt">
    <h4 style="margin-bottom: 0.5rem;">Stay Updated!</h4>
    <p style="font-size: 0.9rem; color: var(--primary-600);">Get notified about price drops and booking updates</p>
    <div class="prompt-actions">
        <button class="prompt-btn prompt-allow" onclick="enableNotifications()">Allow</button>
        <button class="prompt-btn prompt-deny" onclick="dismissNotifications()">Not Now</button>
    </div>
</div>

<script>
// ENHANCED COMPONENTS JAVASCRIPT
function openLiveChat() {
    // Integration with live chat service
    console.log('Opening live chat...');
    // Example: window.Intercom('show');
}

function toggleHighContrast() {
    document.body.classList.toggle('high-contrast');
    localStorage.setItem('highContrast', document.body.classList.contains('high-contrast'));
}

function enableNotifications() {
    if ('Notification' in window) {
        Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
                new Notification('TravelAI', {
                    body: 'You\'ll now receive travel updates and price alerts!',
                    icon: '/favicon.ico'
                });
            }
        });
    }
    document.getElementById('notification-prompt').classList.remove('show');
}

function dismissNotifications() {
    document.getElementById('notification-prompt').classList.remove('show');
    localStorage.setItem('notificationsDismissed', 'true');
}

// Show notification prompt after 30 seconds if not dismissed
setTimeout(() => {
    if (!localStorage.getItem('notificationsDismissed')) {
        document.getElementById('notification-prompt').classList.add('show');
    }
}, 30000);

// Load high contrast preference
if (localStorage.getItem('highContrast') === 'true') {
    document.body.classList.add('high-contrast');
}

// Error handling
window.addEventListener('error', function(e) {
    console.error('Global error:', e);
    document.getElementById('error-container').style.display = 'block';
});

// Copy to clipboard function
function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        // Show success message
        const toast = document.createElement('div');
        toast.textContent = 'Copied to clipboard!';
        toast.style.cssText = `
            position: fixed; top: 100px; right: 2rem; background: var(--emerald);
            color: white; padding: 0.75rem 1rem; border-radius: 0.5rem;
            z-index: 2000; animation: slideIn 0.3s ease;
        `;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
    });
}

// Advanced search toggle
function toggleAdvancedSearch() {
    const panel = document.querySelector('.advanced-search-panel');
    if (panel) {
        panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
    }
}

// Price alert toggle
function togglePriceAlert(element) {
    element.classList.toggle('active');
    const isActive = element.classList.contains('active');
    console.log('Price alerts:', isActive ? 'enabled' : 'disabled');
}
</script>